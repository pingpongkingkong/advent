import re, itertools
print reduce(lambda x,y: x+int(y[0]) if y[1]==y[2] else x, [ (match[1], match[2], ''.join(map(lambda x: chr(x[0]), sorted(map(lambda group: (group[0],len(list(group[1]))), itertools.groupby(sorted(list(match[0].replace('-',''))),ord)), cmp=lambda y,z: cmp(z[1],y[1]) if cmp(z[1],y[1]) != 0 else cmp(y[0],z[0]) ))[:5])) for match in (re.match(r'^(.*)-(\d+)\[(\w+)\]$', line).groups() for line in open('input.txt'))], 0)
